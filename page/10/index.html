<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     PxSite
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

<link rel="alternate" href="/atom.xml" title="PxSite" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">PxSite</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>

<div id="main">
  <section class="outer">
  <article class="articles">
    
    
    
    
    <article
  id="post-old/JSON和JSONP"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/06/15/old/JSON%E5%92%8CJSONP/"
    >JSON和JSONP</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/06/15/old/JSON%E5%92%8CJSONP/" class="article-date">
  <time datetime="2016-06-15T06:06:29.000Z" itemprop="datePublished">2016-06-15</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Other-Code/">Other Code</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<div style="top:0px">&#65279;&#65279;</div>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">前言</strong></p>
<p style="">　　由于Sencha Touch 2这种开发模式的特性，基本决定了它原生的数据交互行为几乎只能通过AJAX来实现。</p>
<p style="">　　当然了，通过调用强大的PhoneGap插件然后打包，你可以实现100%的Socket通讯和本地数据库功能，又或者通过HTML5的WebSocket也可以实现与服务器的通讯和服务端推功能，但这两种方式都有其局限性，前者需要PhoneGap支持，后者要求用户设备必须支持WebSocket，因此都不能算是ST2的原生解决方案，原生的只有AJAX。</p>
<p style="">　　说到AJAX就会不可避免的面临两个问题，第一个是AJAX以何种&#26684;式来交换数据？第二个是跨域的需求如何解决？这两个问题目前都有不同的解决方案，比如数据可以用自定义字符串或者用XML来描述，跨域可以通过服务器端代理来解决。</p>
<p style="">　　但到目前为止最被推崇或者说首选的方案还是用JSON来传数据，靠JSONP来跨域。而这就是本文将要讲述的内容。</p>
<p style="">　　JSON(JavaScript Object Notation)和JSONP(JSON with Padding)虽然只有一个字母的差别，但其实他们根本不是一回事儿：JSON是一种数据交换&#26684;式，而JSONP是一种依靠开发人员的聪明才智创造出的一种非官方跨域数据交互协议。我们拿最近比较火的谍战片来打个比方，JSON是地下党们用来书写和交换情报的“暗号”，而JSONP则是把用暗号书写的情报传递给自己同志时使用的接头方式。看到没？一个是描述信息的&#26684;式，一个是信息传递双方约定的方法。</p>
<p style="">　　既然随便聊聊，那我们就不再采用教条的方式来讲述，而是把关注重心放在帮助开发人员理解是否应当选择使用以及如何使用上。</p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　什么是JSON</strong></p>
<p style="">　　前面简单说了一下，JSON是一种基于文本的数据交换方式，或者叫做数据描述&#26684;式，你是否该选用他首先肯定要关注它所拥有的优点。<img alt="" src="http://pic001.cnblogs.com/images/2012/145819/2012042220142826.jpg" style="margin:0px auto; padding:0px; border:currentColor; color:rgb(35,35,35); font-family:verdana,Arial,Helvetica,sans-serif; font-size:12px; display:block; max-width:620px"></p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　JSON的优点：</strong></p>
<p style="">　　1、基于纯文本，跨平台传递极其简单；</p>
<p style="">　　2、Javascript原生支持，后台语言几乎全部支持；</p>
<p style="">　　3、轻量级数据&#26684;式，占用字符数量极少，特别适合互联网传递；</p>
<p style="">　　4、可读性较强，虽然比不上XML那么一目了然，但在合理的依次缩进之后还是很容易识别的；</p>
<p style="">　　5、容易编写和解析，当然前提是你要知道数据结构；</p>
<p style="">　　JSON的缺点当然也有，但在作者看来实在是无关紧要的东西，所以不再单独说明。</p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　JSON的&#26684;式或者叫规则：</strong></p>
<p style="">　　JSON能够以非常简单的方式来描述数据结构，XML能做的它都能做，因此在跨平台方面两者完全不分伯仲。</p>
<p style="">　　1、JSON只有两种数据类型描述符，大括号{}和方括号[]，其余英文冒号:是映射符，英文逗号,是分隔符，英文双引号&quot;&quot;是定义符。</p>
<p style="">　　2、大括号{}用来描述一组“不同类型的无序键&#20540;对集合”（每个键&#20540;对可以理解为OOP的属性描述），方括号[]用来描述一组“相同类型的有序数据集合”（可对应OOP的数组）。</p>
<p style="">　　3、上述两种集合中若有多个子项，则通过英文逗号,进行分隔。</p>
<p style="">　　4、键&#20540;对以英文冒号:进行分隔，并且建议键名都加上英文双引号”&quot;，以便于不同语言的解析。</p>
<p style="">　　5、JSON内部常用数据类型无非就是字符串、数字、布尔、日期、null 这么几个，字符串必须用双引号引起来，其余的都不用，日期类型比较特殊，这里就不展开讲述了，只是建议如果客户端没有按日期排序功能需求的话，那么把日期时间直接作为字符串传递就好，可以省去很多麻烦。</p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　JSON实例：</strong></p>
<div class="cnblogs_code" style="">
<pre style=""><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px"> 描述一个人</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"> 
var person </span>=<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"> {
    </span>&quot;Name&quot;: &quot;Bob&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,
    </span>&quot;Age&quot;: 32<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,
    </span>&quot;Company&quot;: &quot;IBM&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,
    </span>&quot;Engineer&quot;: <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">true</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">
}

<p></span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px"> 获取这个人的信息</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>var personAge </span>=<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"> person.Age;</p>
<p></span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px"> 描述几个人</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>var members </span>=<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"> [<br>    {<br>        </span>&quot;Name&quot;: &quot;Bob&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Age&quot;: 32<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Company&quot;: &quot;IBM&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Engineer&quot;: <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">true</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>    },<br>    {<br>        </span>&quot;Name&quot;: &quot;John&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Age&quot;: 20<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Company&quot;: &quot;Oracle&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Engineer&quot;: <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">false</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>    },<br>    {<br>        </span>&quot;Name&quot;: &quot;Henry&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Age&quot;: 45<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Company&quot;: &quot;Microsoft&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>        </span>&quot;Engineer&quot;: <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">false</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>    }<br>]</p>
<p></span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px"> 读取其中John的公司名称</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>var johnsCompany </span>= members[1<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">].Company;</p>
<p></span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px"> 描述一次会议</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>var conference </span>=<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"> {<br>    </span>&quot;Conference&quot;: &quot;Future Marketing&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>    </span>&quot;Date&quot;: &quot;2012-6-1&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>    </span>&quot;Address&quot;: &quot;Beijing&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>    </span>&quot;Members&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">:<br>    [<br>        {<br>            </span>&quot;Name&quot;: &quot;Bob&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Age&quot;: 32<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Company&quot;: &quot;IBM&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Engineer&quot;: <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">true</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>        },<br>        {<br>            </span>&quot;Name&quot;: &quot;John&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Age&quot;: 20<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Company&quot;: &quot;Oracle&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Engineer&quot;: <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">false</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>        },<br>        {<br>            </span>&quot;Name&quot;: &quot;Henry&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Age&quot;: 45<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Company&quot;: &quot;Microsoft&quot;<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">,<br>            </span>&quot;Engineer&quot;: <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">false</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>        }<br>    ]<br>}</p>
<p></span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px"> 读取参会者Henry是否工程师</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px"><br>var henryIsAnEngineer </span>= conference.Members[2].Engineer;</pre></p>
</div>
<p style="">　　关于JSON，就说这么多，更多细节请在开发过程中查阅资料深入学习。</p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　什么是JSONP</strong></p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　先说说JSONP是怎么产生的：<img alt="" src="http://pic001.cnblogs.com/images/2012/145819/2012042220173342.png" style="margin:0px auto; padding:0px; border:currentColor; color:rgb(35,35,35); font-family:verdana,Arial,Helvetica,sans-serif; font-size:12px; display:block; max-width:620px"></strong></p>
<p style="">　　其实网上关于JSONP的讲解有很多，但却千篇一律，而且云里雾里，对于很多刚接触的人来讲理解起来有些困难，小可不才，试着用自己的方式来阐释一下这个问题，看看是否有帮助。</p>
<p style="">　　1、一个众所周知的问题，Ajax直接请求普通文件存在跨域无权限访问的问题，甭管你是静态页面、动态网页、web服务、WCF，只要是跨域请求，一律不准；</p>
<p style="">　　2、不过我们又发现，Web页面上调用js文件时则不受是否跨域的影响（不仅如此，我们还发现凡是拥有”src”这个属性的标签都拥有跨域的能力，比如&lt;script&gt;、&lt;img&gt;、&lt;iframe&gt;）；</p>
<p style="">　　3、于是可以判断，当前阶段如果想通过纯web端（ActiveX控件、服务端代理、属于未来的HTML5之Websocket等方式不算）跨域访问数据就只有一种可能，那就是在远程服务器上设法把数据装进js&#26684;式的文件里，供客户端调用和进一步处理；</p>
<p style="">　　4、恰巧我们已经知道有一种叫做JSON的纯字符数据&#26684;式可以简洁的描述复杂数据，更妙的是JSON还被js原生支持，所以在客户端几乎可以随心所欲的处理这种&#26684;式的数据；</p>
<p style="">　　5、这样子解决方案就呼之欲出了，web客户端通过与调用脚本一模一样的方式，来调用跨域服务器上动态生成的js&#26684;式文件（一般以JSON为后缀），显而易见，服务器之所以要动态生成JSON文件，目的就在于把客户端需要的数据装入进去。</p>
<p style="">　　6、客户端在对JSON文件调用成功之后，也就获得了自己所需的数据，剩下的就是按照自己需求进行处理和展现了，这种获取远程数据的方式看起来非常像AJAX，但其实并不一样。</p>
<p style="">　　7、为了便于客户端使用数据，逐渐形成了一种非正式传输协议，人们把它称作JSONP，该协议的一个要点就是允许用户传递一个callback参数给服务端，然后服务端返回数据时会将这个callback参数作为函数名来包裹住JSON数据，这样客户端就可以随意定制自己的函数来自动处理返回数据了。</p>
<p style="">　　如果对于callback参数如何使用还有些模糊的话，我们后面会有具体的实例来讲解。</p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　JSONP的客户端具体实现：</strong></p>
<p style="">　　不管jQuery也好，ExtJs也罢，又或者是其他支持jsonp的框架，他们幕后所做的工作都是一样的，下面我来循序渐进的说明一下jsonp在客户端的实现：</p>
<p style="">　　1、我们知道，哪怕跨域js文件中的代码（当然指符合web脚本安全策略的），web页面也是可以无条件执行的。</p>
<p style="">　　远程服务器remoteserver.com根目录下有个remote.js文件代码如下：</p>
<div class="cnblogs_code" style="">
<pre style="">alert('我是远程文件');</pre>
</div>
<p style="">　　本地服务器localserver.com下有个jsonp.html页面代码如下：</p>
<div class="cnblogs_code" style="">
<pre style=""><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;!</span><span style="font-family:'Courier New'; font-size:12px; color:#ff0ff; margin:0px; padding:0px">DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">xmlns</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;http://www.w3.org/1999/xhtml&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">type</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;text/javascript&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px"> src</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;http://remoteserver.com/remote.js&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>

<p><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span><br><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span></pre></p>
</div>
<p style="">　　毫无疑问，页面将会弹出一个提示窗体，显示跨域调用成功。</p>
<p style="">　　2、现在我们在jsonp.html页面定义一个函数，然后在远程remote.js中传入数据进行调用。</p>
<p style="">　　jsonp.html页面代码如下：</p>
<div class="cnblogs_code" style="">
<pre style=""><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;!</span><span style="font-family:'Courier New'; font-size:12px; color:#ff0ff; margin:0px; padding:0px">DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">xmlns</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;http://www.w3.org/1999/xhtml&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">type</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;text/javascript&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">var</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> localHandler </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">=</span> <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">function</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">(data){
        alert(</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">我是本地函数，可以被跨域的remote.js文件调用，远程js带来的数据是：</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> data.result);
    };
    </span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">type</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;text/javascript&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px"> src</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;http://remoteserver.com/remote.js&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>

<p><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span><br><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span></pre></p>
</div>
<p style="">　　remote.js文件代码如下：</p>
<div class="cnblogs_code" style="">
<pre style="">localHandler({&quot;result&quot;:&quot;我是远程js带来的数据&quot;});</pre>
</div>
<p style="">　　运行之后查看结果，页面成功弹出提示窗口，显示本地函数被跨域的远程js调用成功，并且还接收到了远程js带来的数据。很欣喜，跨域远程获取数据的目的基本实现了，但是又一个问题出现了，我怎么让远程js知道它应该调用的本地函数叫什么名字呢？毕竟是jsonp的服务者都要面对很多服务对象，而这些服务对象各自的本地函数都不相同啊？我们接着往下看。</p>
<p style="">　　3、聪明的开发者很容易想到，只要服务端提供的js脚本是动态生成的就行了呗，这样调用者可以传一个参数过去告诉服务端“我想要一段调用XXX函数的js代码，请你返回给我”，于是服务器就可以按照客户端的需求来生成js脚本并响应了。</p>
<p style="">　　看jsonp.html页面的代码：</p>
<div class="cnblogs_code" style="">
<pre style=""><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;!</span><span style="font-family:'Courier New'; font-size:12px; color:#ff0ff; margin:0px; padding:0px">DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">xmlns</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;http://www.w3.org/1999/xhtml&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">type</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;text/javascript&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 得到航班信息查询结果后的回调函数</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">var</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> flightHandler </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">=</span> <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">function</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">(data){
        alert(</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">你查询的航班结果是：票价 </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> data.price </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 元，</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">余票 </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> data.tickets </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 张。</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">);
    };
    </span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 提供jsonp服务的url地址（不管是什么类型的地址，最终生成的返回&#20540;都是一段javascript代码）</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">var</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> url </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">=</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">http://flightQuery.com/jsonp/flightResult.aspx?code=CA1998&amp;callback=flightHandler</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">;
    </span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 创建script标签，设置其属性</span>
    <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">var</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> script </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">=</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> document.createElement(</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">script</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">);
    script.setAttribute(</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">src</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">, url);
    </span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 把script标签加入head，此时调用开始</span>
<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">    document.getElementsByTagName(</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">head</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">)[</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">0</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">].appendChild(script);
    </span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>

<p><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span><br><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span></pre></p>
</div>
<p style="">　　这次的代码变化比较大，不再直接把远程js文件写死，而是编码实现动态查询，而这也正是jsonp客户端实现的核心部分，本例中的重点也就在于如何完成jsonp调用的全过程。</p>
<p style="">　　我们看到调用的url中传递了一个code参数，告诉服务器我要查的是CA1998次航班的信息，而callback参数则告诉服务器，我的本地回调函数叫做flightHandler，所以请把查询结果传入这个函数中进行调用。</p>
<p style="">　　OK，服务器很聪明，这个叫做flightResult.aspx的页面生成了一段这样的代码提供给jsonp.html（服务端的实现这里就不演示了，与你选用的语言无关，说到底就是拼接字符串）：</p>
<div class="cnblogs_code" style="">
<pre style=""><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px">flightHandler({
    &quot;code&quot;: &quot;CA1998&quot;,
    &quot;price&quot;: 1780,
    &quot;tickets&quot;: 5
});</span></pre>
</div>
<p style="">　　我们看到，传递给flightHandler函数的是一个json，它描述了航班的基本信息。运行一下页面，成功弹出提示窗口，jsonp的执行全过程顺利完成！</p>
<p style="">　　4、到这里为止的话，相信你已经能够理解jsonp的客户端实现原理了吧？剩下的就是如何把代码封装一下，以便于与用户界面交互，从而实现多次和重复调用。</p>
<p style="">　　什么？你用的是jQuery，想知道jQuery如何实现jsonp调用？好吧，那我就好人做到底，再给你一段jQuery使用jsonp的代码（我们依然沿用上面那个航班信息查询的例子，假定返回jsonp结果不变）：</p>
<div class="cnblogs_code" style="">
<pre style=""><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;!</span><span style="font-family:'Courier New'; font-size:12px; color:#ff0ff; margin:0px; padding:0px">DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
 <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">xmlns</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;http://www.w3.org/1999/xhtml&quot;</span> <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
 <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
     <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>Untitled Page<span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">title</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
      <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">type</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;text/javascript&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px"> src</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=jquery.min.js&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
      <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script </span><span style="font-family:'Courier New'; font-size:12px; color:#ff00; margin:0px; padding:0px">type</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">=&quot;text/javascript&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">
     jQuery(document).ready(</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">function</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">(){
        $.ajax({
             type: </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">get</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">,
             async: </span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">false</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">,
             url: </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">http://flightQuery.com/jsonp/flightResult.aspx?code=CA1998</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">,
             dataType: </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">jsonp</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">,
             jsonp: </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">callback</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">,</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(一般默认为:callback)</span>
<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">             jsonpCallback:</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">flightHandler</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&quot;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">,</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">//</span><span style="font-family:'Courier New'; font-size:12px; color:#0800; margin:0px; padding:0px; background-color:rgb(245,245,245)">自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名，也可以写&quot;?&quot;，jQuery会自动为你处理数据</span>
<span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">             success: </span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">function</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">(json){
                 alert(</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">您查询到航班信息：票价： </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> json.price </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 元，余票： </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> json.tickets </span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">&#43;</span> <span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)"> 张。</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">);
             },
             error: </span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px; background-color:rgb(245,245,245)">function</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">(){
                 alert(</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">fail</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">'</span><span style="font-family:'Courier New'; font-size:12px; color:#000000; margin:0px; padding:0px; background-color:rgb(245,245,245)">);
             }
         });
     });
     </span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">script</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
     <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">head</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
  <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
  <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">body</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span>
 <span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&lt;/</span><span style="font-family:'Courier New'; font-size:12px; color:#8000; margin:0px; padding:0px">html</span><span style="font-family:'Courier New'; font-size:12px; color:#00ff; margin:0px; padding:0px">&gt;</span></pre>
</div>
<p style="">　　是不是有点奇怪？为什么我这次没有写flightHandler这个函数呢？而且竟然也运行成功了！哈哈，这就是jQuery的功劳了，jquery在处理jsonp类型的ajax时（还是忍不住吐槽，虽然jquery也把jsonp归入了ajax，但其实它们真的不是一回事儿），自动帮你生成回调函数并把数据取出来供success属性方法来调用，是不是很爽呀？</p>
<p style="">　　好啦，写到这里，我已经无力再写下去，又困又累，得赶紧睡觉。朋友们要是看这不错，觉得有启发，给点个“推荐”呗！由于实在比较简单，所以就不再提供demo源码下载了。</p>
<p style="">　　没想到上了博客园的头条推荐。看到大家对这篇文章的认可和评论，还是很开心的，这里针对ajax与jsonp的异同再做一些补充说明：</p>
<p style=""><strong style="margin:0px; padding:0px; color:rgb(51,51,51); font-weight:bold">　　4月20日下午补充</strong></p>
<p style="">　　1、ajax和jsonp这两种技术在调用方式上“看起来”很像，目的也一样，都是请求一个url，然后把服务器返回的数据进行处理，因此jquery和ext等框架都把jsonp作为ajax的一种形式进行了封装；</p>
<p style="">　　2、但ajax和jsonp其实本质上是不同的东西。ajax的核心是通过XmlHttpRequest获取非本页内容，而jsonp的核心则是动态添加&lt;script&gt;标签来调用服务器提供的js脚本。</p>
<p style="">　　3、所以说，其实ajax与jsonp的区别不在于是否跨域，ajax通过服务端代理一样可以实现跨域，jsonp本身也不排斥同域的数据的获取。</p>
<p style="">　　4、还有就是，jsonp是一种方式或者说非强制性协议，如同ajax一样，它也不一定非要用json&#26684;式来传递数据，如果你愿意，字符串都行，只不过这样不利于用jsonp提供公开服务。</p>
<p style="">　　总而言之，jsonp不是ajax的一个特例，哪怕jquery等巨头把jsonp封装进了ajax，也不能改变这一点！</p>
<p style=""><br>
</p>
<p style="">转载自：<a target="_blank" target="_blank" href="http://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html">http://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/【Egret】中tree组件使用案例"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/05/25/old/%E3%80%90Egret%E3%80%91%E4%B8%ADtree%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B/"
    >【Egret】中tree组件使用案例</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/05/25/old/%E3%80%90Egret%E3%80%91%E4%B8%ADtree%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B/" class="article-date">
  <time datetime="2016-05-25T07:59:18.000Z" itemprop="datePublished">2016-05-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Egret/">Egret</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<p>Egret中tree组件使用案例，包含（文本过多时，自动换行功能）</p>
<p>下面代码结合<a target="_blank" target="_blank" href="http://bbs.egret.com/forum.php?mod=viewthread&amp;tid=19028&amp;page=1#pid133680">http://bbs.egret.com/forum.php?mod=viewthread&amp;tid=19028&amp;page=1#pid133680</a>这篇文章，修改exml；</p>
<pre code_snippet_id="1696373" snippet_file_name="blog_20160525_1_2120975"  code_snippet_id="1696373" snippet_file_name="blog_20160525_1_2120975" class="html" name="code">private creatTree(): void {
        var dp: egret.gui.ObjectCollection = new egret.gui.ObjectCollection();
        dp.source = { children: [{ dir: true,name: &quot;TreeItem0&quot;,children: [{ name: &quot;TreeItem00大娃娃吾问无为谓\r呜呜呜呜呜呜dawd&quot; },
            { dir: true,name: &quot;TreeItem01&quot;,children: [{ name: &quot;TreeItem010&quot; }] }] },
            { dir: true,name: &quot;TreeItem1&quot;,children: [{ name: &quot;TreeItem10&quot; },{ name: &quot;TreeItem11&quot; }] },{ name: &quot;TreeItem2&quot; }] };

<pre><code>    //设置数据源的父子关系，这样才会缩进 
    egret.gui.ObjectCollection.assignParent(dp.source,&amp;quot;children&amp;quot;,&amp;quot;parent&amp;quot;);

    //创建树 
    var tree: egret.gui.Tree = new egret.gui.Tree();
    tree.labelField = &amp;quot;name&amp;quot;;
    tree.top = 20;
    tree.left = 20;
    tree.right = 20;
    tree.height = 300;
    tree.dataProvider = dp;
    tree.expandItem(dp.getItemAt(0),true);
    this.addChild(tree);

    // 还可以通过iconFunction，设置每一项前面显示的小图标：
    //           tree.iconFunction = this.iconFunc; 
    /*呈现项的icon筛选*/
}

private iconFunc(item: any): any {
    if(item.dir) return &amp;quot;tree_icon_dir_png&amp;quot;;
    else return &amp;quot;tree_icon_file_png&amp;quot;;
} &lt;/pre&gt;</code></pre><p><br>
</p>
<p><img alt="" src="https://img-blog.csdn.net/20160525155913934?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
<p><br>
</p>
<p>完整的项目案例：<a target="_blank" href="https://github.com/arvin0/EgretExamples/tree/master/GUI%20Tree">https://github.com/arvin0/EgretExamples/tree/master/GUI%20Tree</a></p>
<div style="top:786px">&#65279;&#65279;</div>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Egret-TypeScript-Html5-web/" rel="tag">Egret TypeScript Html5 web</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/【Egret】里使用iframe标签达到内嵌多个web界面"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/05/17/old/%E3%80%90Egret%E3%80%91%E9%87%8C%E4%BD%BF%E7%94%A8iframe%E6%A0%87%E7%AD%BE%E8%BE%BE%E5%88%B0%E5%86%85%E5%B5%8C%E5%A4%9A%E4%B8%AAweb%E7%95%8C%E9%9D%A2/"
    >【Egret】里使用iframe标签达到内嵌多个web界面</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/05/17/old/%E3%80%90Egret%E3%80%91%E9%87%8C%E4%BD%BF%E7%94%A8iframe%E6%A0%87%E7%AD%BE%E8%BE%BE%E5%88%B0%E5%86%85%E5%B5%8C%E5%A4%9A%E4%B8%AAweb%E7%95%8C%E9%9D%A2/" class="article-date">
  <time datetime="2016-05-17T09:31:45.000Z" itemprop="datePublished">2016-05-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Egret/">Egret</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<pre>目的：Egret里使用iframe标签达到内嵌多个web界面，模式相当于主swf调用N个子swf的效果；</pre>
<pre>目前在做项目过程中，在使用iframe的时候，碰到了一些功能需求，以及解决方法如下：

</pre>
<pre>一、.在index.html里添加iframe标签，</pre>
<pre>在index.html的&lt;body&gt;标签下，添加iframe标签，包括：路径，宽，高，坐标X，Y，是否出现滚动条，等属性；</pre>
<pre>想要详细了解其意思的话，请阅读 http://www.w3school.com.cn/tags/tag_iframe.asp
</pre>
<pre>有两种方法：</pre>
<pre>1.</pre>
<pre code_snippet_id="1686773" snippet_file_name="blog_20160517_1_1276352"  code_snippet_id="1686773" snippet_file_name="blog_20160517_1_1276352" class="html" name="code">&lt;style type=&quot;text/css&quot;&gt; 
.wrapper
 { width:1104px; height:570px; margin:100px 30px; overflow:hidden; position:relative; }
 .iframe { width:1024px;height:768px; position:absolute; top:10px; left:50px; }
 &lt;/style&gt; 
&lt;div class=&quot;wrapper&quot;&gt; 
&lt;iframe class=&quot;iframe&quot; src=&quot;http://www.baidu.com&quot; scrolling=&quot;no&quot; frameborder=&quot;0&quot;&gt;
 &lt;/iframe&gt;
 &lt;/div&gt;</pre>
<pre>2.</pre>
<pre code_snippet_id="1686773" snippet_file_name="blog_20160517_2_8004728"  code_snippet_id="1686773" snippet_file_name="blog_20160517_2_8004728" class="html" name="code">&lt;iframe id=&quot;page1&quot; width=1104 height=570 frameborder=0 scrolling=auto src=&quot;resource/assets/Html/Mobile/index.html?v=&lt;?=$ver?&gt;&quot; style=&quot;position: absolute; top: 100px; left: 200px;&quot;&gt;&lt;/iframe&gt;
&nbsp;</pre>
<pre>二、添加标签完成之后，如何让iframe内容跟随主html进行缩放，</pre>
<pre>方法：</pre>
<pre>在 style 属性方法里，添加</pre>
<pre code_snippet_id="1686773" snippet_file_name="blog_20160518_3_3525053"  code_snippet_id="1686773" snippet_file_name="blog_20160518_3_3525053" class="html" name="code">width:100%;height:100%;</pre>这句代码，就可以达到让iframe内容跟随主html进行缩放的效果；完整的代码如下：<pre code_snippet_id="1686773" snippet_file_name="blog_20160518_4_3143369"  code_snippet_id="1686773" snippet_file_name="blog_20160518_4_3143369" class="html" name="code"> &lt;iframe id=&quot;page1&quot; width=1104 height=570 frameborder=0 scrolling=auto src=&quot;&quot; style=&quot;width:50%;height:50%; position: absolute; top: 0px; left: 0px;&quot;&gt;&lt;/iframe&gt;

<p></pre></p>
<pre>三、解决缩放问题后，如何控制iframe内容刷新，更换不同的链接呢？并且是在egret里进行控制</pre>
<pre>方法如下：</pre>
<pre>在 index.html里的&lt;script&gt;标签下，添加 函数，用来根据情况设定 iframe的src（可以考察：<a target="_blank" target="_blank" href="http://www.cnblogs.com/fanyf/p/3651523.html">http://www.cnblogs.com/fanyf/p/3651523.html</a>）</pre>
<p></p>
<pre code_snippet_id="1686773" snippet_file_name="blog_20160518_5_8824970"  code_snippet_id="1686773" snippet_file_name="blog_20160518_5_8824970" class="html" name="code">function setPage(bool)
{
    if(bool == false)
    {
        var bgm = document.getElementById('page1');
        var name = &quot;resource/assets/Html/PC/index.html?v=&lt;?=$ver?&gt;&quot;;
        bgm.src = name;
    }else
    {
        var bgm = document.getElementById('page1');
        var name = &quot;resource/assets/Html/Mobile/index.html?v=&lt;?=$ver?&gt;&quot;;
        bgm.src = name;
    }
}</pre><br>
<pre>然后在egret代码里对这个函数进行引用，其方法如下：</pre>
<pre code_snippet_id="1686773" snippet_file_name="blog_20160518_6_46470"  code_snippet_id="1686773" snippet_file_name="blog_20160518_6_46470" class="html" name="code">window[&quot;setPage&quot;](true);</pre>
<pre>到这步，基本功能就完成了；

<p></pre></p>
<pre>四、但是有时候想清除iframe的内容，让他为空，隐藏，该怎么做呢？</pre>
<pre>方法如下：</pre>
<pre>需要把iframe的src设为空，页面就不会显示了，不过设为空之后，会出现一个404提示，我目前解决方法是添加一句&nbsp; bgm.visible = false;不过这方法在chrome里能执行，在ie里没有效果</pre>
<pre code_snippet_id="1686773" snippet_file_name="blog_20160518_7_5204683"  code_snippet_id="1686773" snippet_file_name="blog_20160518_7_5204683" class="html" name="code">var bgm = document.getElementById('page1');
var name = &quot; &quot;;
bgm.src = name;
bgm.visible = false;</pre><br>
<br>
<p></p>
<p><br>
</p>
<p><br>
<br>
</p>
<p><br>
</p>
<p><br>
</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Egret-TypeScript-html5-web/" rel="tag">Egret TypeScript html5 web</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/使用VS开发 Node.js指南"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/05/12/old/%E4%BD%BF%E7%94%A8VS%E5%BC%80%E5%8F%91%20Node.js%E6%8C%87%E5%8D%97/"
    >使用VS开发 Node.js指南</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/05/12/old/%E4%BD%BF%E7%94%A8VS%E5%BC%80%E5%8F%91%20Node.js%E6%8C%87%E5%8D%97/" class="article-date">
  <time datetime="2016-05-12T06:15:51.000Z" itemprop="datePublished">2016-05-12</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Software/">Software</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<div style="top:0px">参考：<a target="_blank" href="https://www.visualstudio.com/features/node-js-vs" target="_blank">https://www.visualstudio.com/features/node-js-vs</a>&#65279;&#65279;</div>
<p>这篇文章主要介绍了使用VS开发 Node.js的方法，主要是使用NTVS（Node.js Toolsfor Visual Studio）来实现，有需要的小伙伴参考下</p>
<p>NTVS(Node.jsToolsforVisualStudio)是一款 可以运行在VS2012、VS2013上的一个IDE工具。 使用这个插件对于我们传统.net的开发人员学习node.js无疑是一大福音！</p>
<p>NTVS也是开源的，它支持编辑，智能感知，分析，npm，本地与远程调试，以及发布到Azure网站和云服务。</p>
<p><a target="_blank" href="http://nodejstools.codeplex.com/" target="_blank">NTVS</a><a target="_blank" href="http://nodejstools.codeplex.com/" target="_blank">下载地址</a></p>
<p><a target="_blank" href="http://www.jb51.net/article/33086.htm" target="_blank">装之前不用多说 先把node.js的一套东西给装齐了</a></p>
<p><strong>1·安装</strong><a target="_blank" href="http://nodejstools.codeplex.com/" target="_blank"><strong>NTVS</strong></a><a target="_blank" href="http://nodejstools.codeplex.com/" target="_blank"><strong>下载地址</strong></a>（直接下一步-下一步）</p>
<p><a target="_blank" href="https://github.com/Microsoft/nodejstools/releases/tag/v1.2.Alpha">https://github.com/Microsoft/nodejstools/releases/tag/v1.2.Alpha</a>下载地址：</p>
<p><br>
</p>
<p><img alt="" src="http://files.jb51.net/file_images/article/201501/2015010611014115.png"><br>
</p>
<div class="imageplus-append" id="f21ac82b21eeb7322631b6aa94e17f451lwte51" style="margin:0px 0px 0px 0pt; padding:0px; border:currentColor; width:506px">
<div class="imageplus-append-box" id="w-tc0rqi">
<div id="w-tc0rqi-widget-isolated-host" style="margin:0px; padding:0px; border:currentColor; overflow:visible; display:block; position:static">
<iframe frameborder="0" scrolling="no" vspace="0" hspace="0" style="margin: 0px; padding: 0px; border: currentColor; border-image: none; width: 100%; height: 74px; vertical-align: baseline; display: block; position: static;" allowtransparency="true"></iframe></div></div></div><p><br /></p><p></p><p><strong>2.打开VS2013</strong></p><p><img alt="" src="http://files.jb51.net/file_images/article/201501/2015010611014116.png" /><br /><div class="imageplus-append" id="f21ac82b21eeb7322631b6aa94e17f4529ldrqo" style="margin: 0px 0px 0px 0pt; padding: 0px; border: currentColor; border-image: none; width: 654px;" data-rendered="true"><div class="imageplus-append-box" id="w-ayxyk6"> <div id="w-ayxyk6-widget-isolated-host" style="margin: 0px; padding: 0px; border: currentColor; border-image: none; overflow: visible; display: block; position: static; box-sizing: content-box;"><iframe frameborder="0" scrolling="no" vspace="0" hspace="0" style="margin: 0px; padding: 0px; border: currentColor; border-image: none; width: 100%; height: 74px; vertical-align: baseline; display: block; position: static;" allowtransparency="true"></iframe></div>
</div>
</div>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p><br>
</p>
<p></p>
<p><strong>3.欣赏一下目录</strong></p>
<p><img alt="" src="http://files.jb51.net/file_images/article/201501/2015010611014117.png"><br>
</p>
<div class="imageplus-append" id="f21ac82b21eeb7322631b6aa94e17f453siqq9t" style="margin:0px 0px 0px 0pt; padding:0px; border:currentColor; width:371px">
<div class="imageplus-append-box" id="w-1fjrmn">
<div id="w-1fjrmn-widget-isolated-host" style="margin:0px; padding:0px; border:currentColor; overflow:visible; display:block; position:static">
</div>
</div>
</div>
<p></p>
<p><br>
</p>
<p></p>
<p>server.js（有没有很熟悉的感觉）</p>
<p><img alt="" src="http://files.jb51.net/file_images/article/201501/2015010611014118.png"></p>
<p><br>
</p>
<p>本文转自：<a target="_blank" href="http://www.jb51.net/article/59509.htm" target="_blank">http://www.jb51.net/article/59509.htm</a></p>
<div style="top:0px">&#65279;&#65279;</div>
<div style="top:0px">&#65279;&#65279;</div>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/【Egret】里使用audio标签达到默认播放背景音乐"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/05/09/old/%E3%80%90Egret%E3%80%91%E9%87%8C%E4%BD%BF%E7%94%A8audio%E6%A0%87%E7%AD%BE%E8%BE%BE%E5%88%B0%E9%BB%98%E8%AE%A4%E6%92%AD%E6%94%BE%E8%83%8C%E6%99%AF%E9%9F%B3%E4%B9%90/"
    >【Egret】里使用audio标签达到默认播放背景音乐</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/05/09/old/%E3%80%90Egret%E3%80%91%E9%87%8C%E4%BD%BF%E7%94%A8audio%E6%A0%87%E7%AD%BE%E8%BE%BE%E5%88%B0%E9%BB%98%E8%AE%A4%E6%92%AD%E6%94%BE%E8%83%8C%E6%99%AF%E9%9F%B3%E4%B9%90/" class="article-date">
  <time datetime="2016-05-09T11:50:03.000Z" itemprop="datePublished">2016-05-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Egret/">Egret</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<pre code_snippet_id="1676580" snippet_file_name="blog_20160509_1_3227696"  code_snippet_id="1676580" snippet_file_name="blog_20160509_1_3227696" class="javascript" name="code">&lt;audio id=&quot;bgmMusic&quot; style=&quot;position:absolute;&quot; src=&quot;resource/assets/Sound/load.mp3?v=&lt;?=$ver?&gt;&quot; autoplay='autoplay' loop=&quot;loop&quot;&gt;你的浏览器不支持audio标签。&lt;/audio&gt;  

function setBgm(play){
    var bgm = document.getElementById('bgmMusic');
    if(play){
        bgm.play();
    }else{
        bgm.pause();
    }
}

setBgm(true);</pre>
<p>这段代码，写在egret项目里的index.html文件里，audio标签这句代码，写在body标签下；下面的函数写在script标签里；可以直接在这边操作函数</p>
<p>也可以在egret里通过 window[&quot;setBgm&quot;](true) 方法来控制，</p>
<p><img alt="" src="https://img-blog.csdn.net/20160510103014585?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
<p><img alt="" src="https://img-blog.csdn.net/20160510103109049?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
<p><br>
</p>
<p><strong>HTML 5 Audio属性</strong></p>
<ol>
<li>autoplay:唯一可选&#20540;为autoplay，出现autoplay属性并准确赋&#20540;时，音频将会自动播放</li><li>controls：唯一可选&#20540;为controls，出现controls属性并准确赋&#20540;时，音频播放控件将会显示，控件包括：播放、暂停、定位、音量、全屏切换、字幕（如果可用）、音轨（如果可用）。</li><li>loop：唯一可选&#20540;为loop，出现loop属性并准确赋&#20540;时，音频将会循环播放。</li><li>preload：可选&#20540;有auto(当页面加载后载入整个音频)、meta(当页面加载后只载入元数据)和none(当页面加载后不载入音频) 如果设置了前面的autoplay属性，那么preload将会被忽略。</li><li>src：指定音频URL地址，可以是相对的URL也可以是绝对的URL 当然还可以像第2和第3个例子一样，用source标签来指定源。</li></ol>
<p>HTML5的Audio标签使用详解，参考：<a target="_blank" target="_blank" href="http://www.5icool.org/a/201306/a1907.html">http://www.5icool.org/a/201306/a1907.html</a><br>
</p>
<div style="top:0px">&#65279;&#65279;</div>
<div style="top:0px">&#65279;&#65279;</div>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Egret-TypeScript-JavaScript-Html5-audio/" rel="tag">Egret TypeScript JavaScript Html5 audio</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/【Egret】实现web页面操作PC端本地文件操作"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/04/15/old/%E3%80%90Egret%E3%80%91%E5%AE%9E%E7%8E%B0web%E9%A1%B5%E9%9D%A2%E6%93%8D%E4%BD%9CPC%E7%AB%AF%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"
    >【Egret】实现web页面操作PC端本地文件操作</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/04/15/old/%E3%80%90Egret%E3%80%91%E5%AE%9E%E7%8E%B0web%E9%A1%B5%E9%9D%A2%E6%93%8D%E4%BD%9CPC%E7%AB%AF%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" class="article-date">
  <time datetime="2016-04-15T02:16:52.000Z" itemprop="datePublished">2016-04-15</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Egret/">Egret</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<p><strong>Egret 实现web页面操作PC端本地文件操作：</strong><br><br><a target="_blank" href="http://edn.egret.com/cn/book/page/pid/181">http://edn.egret.com/cn/book/page/pid/181</a><br><br><br></p>
<p>//——————————————————————————————————————————————————————————//<br>
</p>
其他html5 操作PC端本地文件的方法参考：<br>
<br>
js<br>
探索HTML5之本地文件系统API - File System API<br>
<a target="_blank" href="http://www.cnblogs.com/gbin1/archive/2012/04/13/2446069.html">http://www.cnblogs.com/gbin1/archive/2012/04/13/2446069.html</a><br>
<br>
h5 文件操作API<br>
<a target="_blank" href="https://www.douban.com/note/510320770/">https://www.douban.com/note/510320770/</a><br>
<br>
让ActiveXObject( &quot;Microsoft.XmlDom &quot;)对象在非IE浏览器下显示数据？firefox（火狐）<br>
<a target="_blank" href="http://blog.csdn.net/lejuo/article/details/11528243">http://blog.csdn.net/lejuo/article/details/11528243</a><br>
<br>
<br>
<br>
<br>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/html5/" rel="tag">html5</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/HTML5 本地存储五种方案"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/04/15/old/HTML5%20%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8%E4%BA%94%E7%A7%8D%E6%96%B9%E6%A1%88/"
    >HTML5 本地存储五种方案</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/04/15/old/HTML5%20%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8%E4%BA%94%E7%A7%8D%E6%96%B9%E6%A1%88/" class="article-date">
  <time datetime="2016-04-15T01:20:30.000Z" itemprop="datePublished">2016-04-15</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/HTML-CSS-JavaScript/">HTML CSS JavaScript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<br>
<strong>1、LocalStorage</strong><br>
LocalStorage就是Key-Value的简单键&#20540;对存储结构，Web Storage除了localStorage的持久性存储外，还<br>
有针对本次回话的sessionStorage方式，一般情况下localStorage较为常用，示例代码如下：<br>
Chrome中 的存储方式是以sqlite的数据库文件形式存储。存在C:\Users\Username\AppData\Local<br>
\Google\Chrome\User Data\Default\Local Storage 中<br>
<pre code_snippet_id="2235012" snippet_file_name="blog_20170301_1_1597638"  name="code" class="javascript">function save(dataModel){

<p>var value = dataModel.serialize();</p>
<p>window.localStorage[‘DataModel’] = value;</p>
<p>window.localStorage[‘DataCount’] = dataModel.size();</p>
<p>console.log(dataModel.size() + ‘ datas are saved’);</p>
<p>return value;</p>
<p>}</p>
<p>function restore(dataModel){</p>
<p>var value = window.localStorage[‘DataModel’];</p>
<p>if(value){</p>
<p>dataModel.deserialize(value);</p>
<p>console.log(window.localStorage[‘DataCount’] + ‘ datas are restored’);</p>
<p>return value;</p>
<p>}</p>
<p>return ‘’;</p>
<p>}</p>
<p>function clear(){</p>
<p>if(window.localStorage[‘DataModel’]){</p>
<p>console.log(window.localStorage[‘DataCount’] + ‘ datas are cleared’);</p>
<p>delete window.localStorage[‘DataModel’];</p>
<p>delete window.localStorage[‘DataCount’];</p>
<p>}</p>
<p>}<br></pre><strong><br><br>2、Cookie</strong><br><br>这种存储方式存储内容很有限，只适合做简单信息存储，存取接口设计得极其反人类，举例如下：<br></p>
<pre code_snippet_id="2235012" snippet_file_name="blog_20170301_2_5632629"  name="code" class="javascript">function getCookieValue(name) {

if (document.cookie.length &gt; 0) {

var start = document.cookie.indexOf(name + &quot;=&quot;);

if (start !== -1) {

start = start + name.length + 1;

var end = document.cookie.indexOf(&quot;;&quot;, start);

if (end === -1){

end = document.cookie.length;

}

return unescape(document.cookie.substring(start, end));

}

}

return '';

}

function save(dataModel) {

var value = dataModel.serialize();

document.cookie = 'DataModel=' + escape(value);

document.cookie = 'DataCount=' + dataModel.size();

console.log(dataModel.size() + ' datas are saved');

return value;

}</pre><br>
<p><strong>3、Indexed Database API</strong><br><br><br><br>IndexedDB可以存储结构对象，可构建key和index的索引方式查找，目前各浏览器的已经逐渐支持<br><br>IndexedDB的存储方式，其使用代码如下，需注意IndexedDB的很多操作接口类&#20284;NodeJS的异步回调方式，<br><br>特别是查询时连cursor的continue都是异步再次回调onsuccess函数的操作方式，因此和NodeJS一样使用上不如同步的代码容易。</p>
<p><pre code_snippet_id="2235012" snippet_file_name="blog_20170301_3_1902875"  name="code" class="javascript">function save(dataModel){

<p>var tx = db.transaction(&quot;meters&quot;, &quot;readwrite&quot;);</p>
<p>var store = tx.objectStore(&quot;meters&quot;);</p>
<p>dataModel.each(function(data){</p>
<p>store.put({</p>
<p>id: data.getId(),</p>
<p>tag: data.getTag(),</p>
<p>name: data.getName(),</p>
<p>meterValue: data.a(‘meter.value’),</p>
<p>meterAngle: data.a(‘meter.angle’),</p>
<p>p3: data.p3(),</p>
<p>r3: data.r3(),</p>
<p>s3: data.s3()</p>
<p>});</p>
<p>});</p>
<p>tx.oncomplete = function() {</p>
<p>console.log(dataModel.size() + ‘ datas are saved’);</p>
<p>};</p>
<p>return dataModel.serialize();</p>
<p>}</pre><br></p>
</p>
<strong>4、FileSystem API</strong><br>
<br>
FileSystem API相当于操作本地文件的存储方式，目前支持浏览器不多，其接口标准也在发展制定变化中<br>
，因此也可以动态生成图片到本地文件，然后通过 filesystem:http:*** 的URL方式直接赋&#20540;给img的<br>
html元素的src访问。<br>
<br>
<pre code_snippet_id="2235012" snippet_file_name="blog_20170301_4_1030040"  name="code" class="javascript">function save(dataModel) {

<p>var value = dataModel.serialize();</p>
<p>fs.root.getFile(‘meters.txt’, {create: true}, function (fileEntry) {</p>
<p>console.log(fileEntry.toURL());</p>
<p>fileEntry.createWriter(function (fileWriter) {</p>
<p>fileWriter.onwriteend = function () {</p>
<p>console.log(dataModel.size() + ‘ datas are saved’);</p>
<p>};</p>
<p>var blob = new Blob([value], {type: ‘text/plain’});</p>
<p>fileWriter.write(blob);</p>
<p>});</p>
<p>});</p>
<p>return value;</p>
<p>}<br></pre><br><br><strong>5、Application Cache</strong><br><br><br><br>window.applicationCache 对象是对浏览器的应用缓存的编程访问方式。其 status 属性可用于查看缓存的当前状态：<br></p>
<pre code_snippet_id="2235012" snippet_file_name="blog_20170301_5_7856693"  name="code" class="javascript">var appCache = window.applicationCache;

switch (appCache.status) {

case appCache.UNCACHED: // UNCACHED == 0

return 'UNCACHED';

break;

case appCache.IDLE: // IDLE == 1

return 'IDLE';

break;

case appCache.CHECKING: // CHECKING == 2

return 'CHECKING';

break;

case appCache.DOWNLOADING: // DOWNLOADING == 3

return 'DOWNLOADING';

break;

case appCache.UPDATEREADY: // UPDATEREADY == 4

return 'UPDATEREADY';

break;

case appCache.OBSOLETE: // OBSOLETE == 5

return 'OBSOLETE';

break;

default:

return 'UKNOWN CACHE STATUS';

break;

};</pre><br>
<br>
<br>
<br>
<br>
<br>
<br>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/JavaScript中使用ActiveXObject操作本地文件夹的方法"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/03/30/old/JavaScript%E4%B8%AD%E4%BD%BF%E7%94%A8ActiveXObject%E6%93%8D%E4%BD%9C%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%A4%B9%E7%9A%84%E6%96%B9%E6%B3%95/"
    >JavaScript中使用ActiveXObject操作本地文件夹的方法</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/03/30/old/JavaScript%E4%B8%AD%E4%BD%BF%E7%94%A8ActiveXObject%E6%93%8D%E4%BD%9C%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%A4%B9%E7%9A%84%E6%96%B9%E6%B3%95/" class="article-date">
  <time datetime="2016-03-30T05:22:16.000Z" itemprop="datePublished">2016-03-30</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<p>原文链接：<a target="_blank" href="http://www.jb51.net/article/48538.htm">http://www.jb51.net/article/48538.htm</a></p>
<div style="top:0px">&#65279;&#65279;</div>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/【Egret】 3D 使用中的一些疑难解决技巧！"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/03/23/old/%E3%80%90Egret%E3%80%91%203D%20%E4%BD%BF%E7%94%A8%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E7%96%91%E9%9A%BE%E8%A7%A3%E5%86%B3%E6%8A%80%E5%B7%A7%EF%BC%81/"
    >【Egret】 3D 使用中的一些疑难解决技巧！</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/03/23/old/%E3%80%90Egret%E3%80%91%203D%20%E4%BD%BF%E7%94%A8%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E7%96%91%E9%9A%BE%E8%A7%A3%E5%86%B3%E6%8A%80%E5%B7%A7%EF%BC%81/" class="article-date">
  <time datetime="2016-03-23T02:58:12.000Z" itemprop="datePublished">2016-03-23</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Egret/">Egret</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<p>1.问题：目前Egret3D中，发布到手机后无法响应鼠标事件</p>
<p>&nbsp;&nbsp; 解决方法：①打开发布后的libs/module/egret/egret.web.min.js，查找e.stopPropagation()，删掉</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;②要注意 不能用MOUSE_CLICK，在移动设备上必须用TOUCH_END<br>
<br>
<br>
</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Egret-TypeScript-Html5/" rel="tag">Egret TypeScript Html5</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-old/【Egret】 2D 使用中的一些疑难解决技巧！"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/03/23/old/%E3%80%90Egret%E3%80%91%202D%20%E4%BD%BF%E7%94%A8%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E7%96%91%E9%9A%BE%E8%A7%A3%E5%86%B3%E6%8A%80%E5%B7%A7%EF%BC%81/"
    >【Egret】 2D 使用中的一些疑难解决技巧！</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2016/03/23/old/%E3%80%90Egret%E3%80%91%202D%20%E4%BD%BF%E7%94%A8%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E7%96%91%E9%9A%BE%E8%A7%A3%E5%86%B3%E6%8A%80%E5%B7%A7%EF%BC%81/" class="article-date">
  <time datetime="2016-03-23T02:55:58.000Z" itemprop="datePublished">2016-03-23</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Egret/">Egret</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <a id="more"></a>


<p><strong>1.问题：声音在ios上无法播放</strong><br><br>&nbsp;&nbsp; 解决方法：①首先需要预加载一个声音<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ②然后目前只有点击之后才能播放声音，不能默认播放<br><br><br><br><strong>2.问题：滚动条问题</strong><br><br>&nbsp; 解决方法：①js原生方法：overflow:auto<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ②egret的scroller组件，但是这个组件有问题；用代码new的话，就会一松手就<br><br>会弹回初始位置；必须在eui编辑器手动添加，才不会有这个BUG；<br><br><br><br><strong>3.问题：获取egret的canvas标签</strong><br><br>解决方法：<br></p>
<pre code_snippet_id="2235030" snippet_file_name="blog_20170301_1_5966529"  code_snippet_id="2235030" snippet_file_name="blog_20170301_1_5966529" name="code" class="javascript">let containerList = document.querySelectorAll(&quot;.egret-player&quot;);
        let length = containerList.length;
        for (let i = 0; i &lt; length; i++) {
            let container = containerList[i];
            let player = &lt;WebPlayer&gt;container[&quot;egret-player&quot;];
            player[&quot;canvas&quot;] //这个就是canvas
        }</pre><br>
<p>一般情况下这个查询结果的列表长度就是1，你只取默认的canvas就不用遍历，直接取第一个container<br><br>这个是源码里的获取方式，拿不到只有一种可能，写错了哪个属性名。<br><br>还有就是在egret初始化结束后再去拿，太早就是空的。等你的Main入口类被调用了就可以拿了<br><br>document.querySelectorAll(&quot;.egret-player&quot;)[0][&quot;egret-player&quot;][&quot;canvas&quot;]<br><br>直接在console输入这个打印<br><br><br><br><br><br><br><br><br></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Egret-TypeScript-Html5/" rel="tag">Egret TypeScript Html5</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/9/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/11/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2020
        <i class="ri-heart-fill heart_icon"></i> Peng Xiang
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        Powered by <a href="https://hexo.io" target="_blank">Hexo</a>
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="PxSite"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="http://shenyu-vip.lofter.com" target="_blank" rel="noopener">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Subtitle -->

<script>
  try {
    var typed = new Typed("#subtitle", {
      strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
      startDelay: 0,
      typeSpeed: 200,
      loop: true,
      backSpeed: 100,
      showCursor: true
    });
  } catch (err) {
    console.log(err)
  }
</script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
</body>

</html>